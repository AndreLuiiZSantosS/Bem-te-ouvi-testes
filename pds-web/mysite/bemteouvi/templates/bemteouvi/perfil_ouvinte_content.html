{% load static %}

<div class="container">
    <h1>{{ ouvinte.user.username }}</h1>
    {% if proprio_perfil %}
        <button id="btn-editar-perfil-ouvinte">Editar Perfil</button>
        <div class="modal-edicao" id="modal-edicao-ouvinte" style="display: none;">
            <div class="conteudo-modal">
                <form id="formulario-edicao-ouvinte" method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <h3>Editar Perfil</h3>
                    <div class="grupo-formulario">
                        <label for="nome-usuario-ouvinte">Nome de usuário</label>
                        <input type="text" id="nome-usuario-ouvinte" name="nome" value="{{ ouvinte.user.username }}" placeholder="Seu nome">
                    </div>
                    <div class="grupo-formulario">
                        <label for="email-usuario-ouvinte">Email</label>
                        <input type="email" id="email-usuario-ouvinte" name="email" value="{{ ouvinte.user.email }}" placeholder="Seu email">
                    </div>
                    <div class="grupo-formulario">
                        <label>Foto de Perfil</label>
                        <div class="grupo-upload">
                            <input type="file" name="foto_perfil" id="input-foto-perfil-ouvinte" accept="image/*">
                            <p class="remover-foto" id="remover-foto-perfil-ouvinte">Remover foto atual</p>
                        </div>
                    </div>
                    <div class="botoes-modal">
                        <button type="submit">Salvar</button>
                        <button type="button" class="botao-cancelar">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>
    {% endif %}

    <!-- Estatísticas -->
    <section class="secao-estatisticas">
        <div class="grade-estatisticas">
            <div class="item-estatistica">
                <div class="valor-estatistica">{{ musicas_ouvidas|default:"0" }}</div>
                <div class="rotulo-estatistica">Músicas ouvidas</div>
            </div>
            <div class="item-estatistica">
                <div class="valor-estatistica">{{ minutos_mes|default:"0" }}</div>
                <div class="rotulo-estatistica">Minutos ouvidos</div>
            </div>
            <div class="item-estatistica">
                <div class="valor-estatistica">
                    {% if genero_favorito %}
                        {{ genero_favorito }} ({{ genero_percentual }}%)
                    {% else %}
                        Nenhum
                    {% endif %}
                </div>
                <div class="rotulo-estatistica">Gênero favorito</div>
            </div>
            <div class="item-estatistica item-grafico">
                <strong>Atividade Diária</strong>
                <div class="barras">
                    {% for min in estatisticas %}
                        <div style="height:{{ min }}%" data-value="{{ min }}%"></div>
                    {% endfor %}
                </div>
                <div class="dias">
                    <span>D</span><span>S</span><span>T</span><span>Q</span><span>Q</span><span>S</span><span>S</span>
                </div>
            </div>
        </div>
    </section>
    <!-- Histórico de Reprodução -->
    <section class="historico-reproducao">
        <h2>Histórico</h2>
        <div class="lista-historico">
        {% for rep in historico %}
            <div class="item-historico">
            {% if rep.musica.capa %}
                <img src="{% if rep.musica.audio %}{{ rep.musica.audio.url }}{% else %}#{% endif %}" alt="{{ rep.musica.titulo }}" class="capa-album">
            {% else %}
                <img src="https://tse4.mm.bing.net/th/id/OIP.FnbT6l8T_ZQoLlnknYBDsAHaHa?rs=1&pid=ImgDetMain"
                 alt="{{ rep.musica.titulo }}" class="capa-album">
            {% endif %}
            <div class="info-musica">
                <div class="titulo-musica">{{ rep.musica.titulo }}</div>
                <div class="artista">{{ rep.musica.musico.user.username }}</div>
                <small>{{ rep.data_hora|date:"d/m/Y H:i" }}</small>
            </div>
            </div>
        {% empty %}
            <div class="item-historico">
            Nenhuma reprodução recente.
            </div>
        {% endfor %}
        </div>
    </section>
</div>